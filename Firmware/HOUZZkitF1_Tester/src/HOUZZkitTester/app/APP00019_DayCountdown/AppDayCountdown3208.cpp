#include "AppDayCountdown3208.h"

NS_DT_BEGIN

const uint8_t icon_day_countdown[] PROGMEM =
{
    0x00,0x98,
0x44,0x47,0x46,0x11,0x08,0x08,0x42,0x00,
0x00,0x00,0xff,0xff,0xff,0x11,0x09,0xff,
0x2c,0x00,0x3c,0x01,0x00,0x07,0x08,0x40,
0x00,0x55,0x55,0xaa,0x91,0xa9,0x01,0x90,
0x06,0x40,0x40,0x44,0x00,0x55,0x55,0x2c,
0x00,0x3c,0x04,0x01,0x01,0x05,0x40,0x20,
0x00,0x00,0x2a,0x80,0x2c,0x00,0x3c,0x04,
0x02,0x01,0x05,0x40,0x20,0x00,0x00,0x2a,
0x80,0x2c,0x00,0x3c,0x03,0x01,0x01,0x06,
0x40,0x20,0x00,0x00,0x25,0x20,0x2c,0x00,
0x3c,0x01,0x00,0x07,0x08,0x40,0x00,0x55,
0x55,0x80,0x91,0x89,0x01,0x90,0x06,0x40,
0x48,0x44,0xa8,0x55,0x55,0x2c,0x00,0x3c,
0x02,0x01,0x01,0x06,0x40,0x20,0x00,0x00,
0x10,0x60,0x2c,0x00,0x3c,0x06,0x01,0x01,
0x06,0x40,0x20,0x00,0x00,0x10,0x60,0x2c,
0x00,0x3c,0x03,0x02,0x01,0x04,0x40,0x20,
0x00,0x00,0x16,0x2c,0x00,0x3c,0x05,0x02,
0x01,0x04,0x40,0x20,0x00,0x00,0x16,0x96
};

bool AppDayCountdownLayer3208::initLayer()
{
    _layerStyle = LayerStyleIconNum3208::create();
    _layerStyle->initWithData(icon_day_countdown+2,GetUint16(icon_day_countdown),this->getData(),this);
    this->addChild(_layerStyle);
    return true;
}

void AppDayCountdownLayer3208::printAction(SpriteCanvas* canvas)
{
    AppDataDayCountdown* data = this->getData();
    if (data->alarming) {
        canvas->setTextColor(DTRGB(255,0,0));
    }
    DateTime now = this->getApp()->now();
    DateTime today = DateTime(now.year(), now.month(), now.day());
    DateTime targetDay = DateTime(data->year, data->month, data->day);
    TimeSpan diff = TimeSpan(targetDay.unixtime() - today.unixtime());
    int16_t diffDay = diff.days();
    canvas->printf("%d",diffDay);
}


NS_DT_END